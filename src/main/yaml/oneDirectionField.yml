incarnation: scafi

variables:
  seed: &seed { min: 0.0, max: 10.0, step: 1.0, default: 0.0 }
  simulation_length: &simulation_length { formula: 100.0 }
  in_cluster_thr: &in_cluster_thr
    type: ArbitraryVariable
    parameters: [ 1.0, [ 0.5, 0.75, 1.1 ] ]
  same_cluster_thr: &same_cluster_thr
    type: ArbitraryVariable
    parameters: [ 0.1, [ 0.05, 0.5, 1.5 ] ]
  candidate_in_hysteresis: &candidate_in_hysteresis
    type: ArbitraryVariable
    parameters: [ 3, [ 0, 5, 10 ] ]

seeds: { scenario: *seed, simulation: *seed }

terminate: { type: AfterTime, parameters: [*simulation_length] }

network-model:
  type: ConnectWithinDistance
  parameters: [0.75]

_gradient: &program
  - time-distribution: 1
    type: Event
    actions:
    - type: RunScafiProgram
      parameters: [ it.casestudy.Clustering ]
  - program: send

layers:
  - type: OneDirectionGradientLayer
    parameters: [ 18.0, -5.0, -5.0, 0.1, 0.0, ]
    molecule: base-temperature
  - type: LayerAggregator
    molecule: temperature

deployments:
  type: Grid
  parameters: [-5, -5, 5, 5, 0.5, 0.5, 0.25, 0.25]
  programs: *program
  contents:
    - molecule: inClusterThr
      concentration: *in_cluster_thr
    - molecule: sameClusterThr
      concentration: *same_cluster_thr
    - molecule: waitingTime
      concentration: *candidate_in_hysteresis

export:
  - type: CSVExporter
    parameters: ["oneDirectionField", 1.0, "./data"]
    data:
      - type: Time
      - type: ClusterCount
